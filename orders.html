<!DOCTYPE html>
<!--
================================================================================
ORDERS.HTML - Trang Lá»‹ch sá»­ ÄÆ¡n hÃ ng
================================================================================

Chá»©c nÄƒng:
- Hiá»ƒn thá»‹ danh sÃ¡ch Ä‘Æ¡n hÃ ng cá»§a user Ä‘Ã£ Ä‘Äƒng nháº­p
- Má»—i Ä‘Æ¡n hÃ ng cÃ³ thá»ƒ má»Ÿ rá»™ng (click) Ä‘á»ƒ xem chi tiáº¿t
- Hiá»ƒn thá»‹ tráº¡ng thÃ¡i Ä‘Æ¡n hÃ ng (mÃ u sáº¯c badge)
- YÃªu cáº§u Ä‘Äƒng nháº­p Ä‘á»ƒ xem

Order Card Structure:
- Header: MÃ£ Ä‘Æ¡n, ngÃ y táº¡o, tráº¡ng thÃ¡i, tá»•ng tiá»n
- Body (áº©n máº·c Ä‘á»‹nh): Chi tiáº¿t sáº£n pháº©m, thÃ´ng tin giao hÃ ng

CÃ¡c element quan trá»ng (ID):
- orderList: Container hiá»ƒn thá»‹ danh sÃ¡ch Ä‘Æ¡n hÃ ng
================================================================================
-->
<html lang="vi">
  <head>
    <!-- ===== META TAGS ===== -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ÄÆ¡n hÃ ng cá»§a tÃ´i - Kvone Coffee</title>
    <meta name="description" content="Xem lá»‹ch sá»­ Ä‘Æ¡n hÃ ng cá»§a báº¡n" />
    <link rel="icon" type="image/png" href="menu/icons/coffee.png" />

    <!-- View Transitions API -->
    <meta name="view-transition" content="same-origin" />
    <meta name="theme-color" content="#54372b" />

    <!-- ===== CSS ===== -->
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="css/main.css" />
  </head>

  <body>
    <div class="page-wrapper">
      <!-- 
        =====================================================================
        HEADER - Navigation chÃ­nh
        Link "ÄÆ¡n hÃ ng" Ä‘Æ°á»£c highlight (active)
        =====================================================================
        -->
      <header class="header">
        <div class="header-container">
          <a href="index.html" class="logo">
            <span class="logo-icon">â˜•</span>
            <span>Kvone Coffee</span>
          </a>

          <nav class="nav" id="mainNav">
            <a href="index.html" class="nav-link">Menu</a>
            <a href="favorites.html" class="nav-link">YÃªu thÃ­ch</a>
            <!-- Active: Trang hiá»‡n táº¡i -->
            <a href="orders.html" class="nav-link active">ÄÆ¡n hÃ ng</a>
          </nav>

          <div class="header-actions">
            <a href="cart.html" class="cart-btn">
              ğŸ›’
              <span class="cart-badge" style="display: none">0</span>
            </a>

            <div
              class="user-menu"
              id="userMenu"
              style="display: none"
              onclick="toggleUserDropdown()"
            >
              <div class="avatar">U</div>
              <span class="user-name">User</span>
            </div>

            <div id="authLinks" style="display: flex; gap: var(--space-2)">
              <a href="login.html" class="btn btn-ghost btn-sm">ÄÄƒng nháº­p</a>
              <a href="register.html" class="btn btn-secondary btn-sm"
                >ÄÄƒng kÃ½</a
              >
            </div>

            <button class="mobile-menu-btn btn btn-ghost" id="mobileMenuBtn" onclick="document.querySelector('.nav').classList.toggle('active')">
              â˜°
            </button>
          </div>
        </div>
      </header>

      <!-- 
        =====================================================================
        MAIN CONTENT
        =====================================================================
        -->
      <main class="main-content">
        <div
          class="container"
          style="padding: var(--space-8) var(--container-padding)"
        >
          <!-- Page Title -->
          <h1 style="margin-bottom: var(--space-6)">ğŸ“‹ ÄÆ¡n hÃ ng cá»§a tÃ´i</h1>

          <!-- 
                ORDER LIST Container
                Ná»™i dung Ä‘Æ°á»£c render báº±ng JavaScript
                - Náº¿u chÆ°a Ä‘Äƒng nháº­p: Hiá»ƒn thá»‹ yÃªu cáº§u login
                - Náº¿u Ä‘Ã£ Ä‘Äƒng nháº­p: Hiá»ƒn thá»‹ danh sÃ¡ch Ä‘Æ¡n hÃ ng
                - Náº¿u khÃ´ng cÃ³ Ä‘Æ¡n: Hiá»ƒn thá»‹ empty state
                -->
          <div class="order-list" id="orderList">
            <!-- Render báº±ng JavaScript trong renderUserOrders() -->
          </div>
        </div>
      </main>

      <!-- 
        =====================================================================
        FOOTER
        =====================================================================
        -->
      <footer class="footer">
        <div class="footer-container">
          <div class="footer-brand">
            <div class="footer-logo">
              <span>â˜•</span>
              <span>Kvone Coffee</span>
            </div>
            <p class="footer-desc">
              NÆ¡i má»—i ly cÃ  phÃª lÃ  má»™t tÃ¡c pháº©m nghá»‡ thuáº­t, Ä‘Æ°á»£c pha cháº¿ vá»›i
              tÃ¬nh yÃªu vÃ  sá»± táº­n tÃ¢m.
            </p>
          </div>

          <div>
            <h4 class="footer-title">LiÃªn káº¿t</h4>
            <div class="footer-links">
              <a href="index.html" class="footer-link">â˜• Menu</a>
              <a href="favorites.html" class="footer-link">ğŸ’• YÃªu thÃ­ch</a>
              <a href="orders.html" class="footer-link">ğŸ“‹ ÄÆ¡n hÃ ng</a>
            </div>
          </div>

          <div>
            <h4 class="footer-title">LiÃªn há»‡</h4>
            <div class="footer-links">
              <span class="footer-link">ğŸ“ Nguyá»…n VÄƒn Linh, ÄÃ  Náºµng</span>
              <span class="footer-link">ğŸ“ 0905580275</span>
              <span class="footer-link">âœ‰ï¸ kvonecoffee@gmail.com</span>
              <span class="footer-link">â° 7:00 - 22:00 hÃ ng ngÃ y</span>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
          Â© 2024 Kvone Coffee. Made with â¤ï¸ for coffee lovers.
        </div>
      </footer>
    </div>

    <!-- 
    =========================================================================
    USER DROPDOWN MENU
    =========================================================================
    -->
    <div
      id="userDropdown"
      class="card"
      style="
        display: none;
        position: fixed;
        top: 70px;
        right: 100px;
        min-width: 220px;
        z-index: 1000;
        box-shadow: var(--shadow-2xl);
      "
    >
      <div class="card-body" style="padding: var(--space-2)">
        <a
          href="orders.html"
          class="btn btn-ghost w-full"
          style="justify-content: flex-start; gap: var(--space-3)"
          >ğŸ“‹ ÄÆ¡n hÃ ng cá»§a tÃ´i</a
        >
        <a
          href="favorites.html"
          class="btn btn-ghost w-full"
          style="justify-content: flex-start; gap: var(--space-3)"
          >â¤ï¸ YÃªu thÃ­ch</a
        >
        <a
          href="admin.html"
          id="adminLink"
          class="btn btn-ghost w-full"
          style="
            display: none;
            justify-content: flex-start;
            gap: var(--space-3);
            color: var(--color-primary);
          "
        >
          âš™ï¸ Quáº£n lÃ½ Admin
        </a>
        <div class="divider" style="margin: var(--space-2) 0"></div>
        <button
          class="btn btn-ghost w-full"
          style="
            justify-content: flex-start;
            gap: var(--space-3);
            color: var(--color-error);
          "
          onclick="logout()"
        >
          ğŸšª ÄÄƒng xuáº¥t
        </button>
      </div>
    </div>

    <!-- 
    =========================================================================
    JAVASCRIPT FILES
    LÆ°u Ã½: Cáº§n load orders.js cho trang nÃ y
    =========================================================================
    -->
    <script src="js/storage.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/products.js"></script>
    <script src="js/sizes.js"></script>
    <script src="js/toppings.js"></script>
    <script src="js/cart.js"></script>
    <script src="js/favorites.js" ></script>
    <script src="js/orders.js" ></script>
    <!-- Orders management -->
    <script src="js/app.js"></script>
    <script src="js/enhancements.js"></script>

    <!-- 
    =========================================================================
    INLINE JAVASCRIPT
    =========================================================================
    -->
    <script>
      // =====================================================================
      // TOGGLE USER DROPDOWN
      // =====================================================================
      function toggleUserDropdown() {
        const dropdown = document.getElementById("userDropdown");
        dropdown.style.display =
          dropdown.style.display === "none" ? "block" : "none";
      }

      // =====================================================================
      // CLICK OUTSIDE TO CLOSE DROPDOWN
      // =====================================================================
      document.addEventListener("click", function (e) {
        const userMenu = document.getElementById("userMenu");
        const dropdown = document.getElementById("userDropdown");

        if (!userMenu?.contains(e.target) && !dropdown?.contains(e.target)) {
          if (dropdown) dropdown.style.display = "none";
        }
      });

      // =====================================================================
      // DOM CONTENT LOADED
      // =====================================================================
      document.addEventListener("DOMContentLoaded", function () {
        // Khá»Ÿi táº¡o app
        initApp();

        // Hiá»ƒn thá»‹ Admin link náº¿u lÃ  admin
        if (isAdmin()) {
          const adminLink = document.getElementById("adminLink");
          if (adminLink) adminLink.style.display = "flex";
        }

        // ===== KIá»‚M TRA ÄÄ‚NG NHáº¬P =====
        // Trang nÃ y yÃªu cáº§u Ä‘Äƒng nháº­p Ä‘á»ƒ xem Ä‘Æ¡n hÃ ng
        if (!isLoggedIn()) {
          // Hiá»ƒn thá»‹ yÃªu cáº§u Ä‘Äƒng nháº­p
          document.getElementById("orderList").innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ”</div>
                        <h3 class="empty-state-title">Vui lÃ²ng Ä‘Äƒng nháº­p</h3>
                        <p class="empty-state-text">ÄÄƒng nháº­p Ä‘á»ƒ xem lá»‹ch sá»­ Ä‘Æ¡n hÃ ng cá»§a báº¡n.</p>
                        <!-- 
                        Link login vá»›i return URL
                        Sau khi Ä‘Äƒng nháº­p sáº½ quay láº¡i trang nÃ y
                        encodeURIComponent() mÃ£ hÃ³a URL Ä‘á»ƒ truyá»n qua query string
                        -->
                        <a href="login.html?return=${encodeURIComponent(
                          window.location.href
                        )}" class="btn btn-primary">ÄÄƒng nháº­p</a>
                    </div>
                `;
          return;
        }

        // ===== RENDER DANH SÃCH ÄÆ N HÃ€NG =====
        // Gá»i hÃ m tá»« orders.js
        // HÃ m nÃ y tá»± xá»­ lÃ½ trÆ°á»ng há»£p khÃ´ng cÃ³ Ä‘Æ¡n hÃ ng
        renderUserOrders(document.getElementById("orderList"));
      });
    </script>

    <!-- 
    =========================================================================
    INLINE CSS - Styles cho order card accordion
    =========================================================================
    -->
    <style>
      /* 
        ORDER CARD ACCORDION EFFECT
        Má»—i order card cÃ³ 2 pháº§n: header vÃ  body
        Body Ä‘Æ°á»£c áº©n máº·c Ä‘á»‹nh, hiá»‡n khi card cÃ³ class 'expanded'
        */

      /* Body áº©n máº·c Ä‘á»‹nh */
      .order-card .order-body {
        display: none;
      }

      /* Khi card Ä‘Æ°á»£c má»Ÿ rá»™ng, hiá»‡n body */
      .order-card.expanded .order-body {
        display: block;
      }

      /* Xoay mÅ©i tÃªn khi má»Ÿ rá»™ng */
      .order-card.expanded .order-header span:last-child {
        transform: rotate(180deg);
      }
    </style>
  </body>
</html>
